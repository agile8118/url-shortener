sudo: required
language: node_js

node_js:
  - 10

services:
  - mysql

before_install:
  - mysql -e 'CREATE DATABASE url_shortener;'
  - cd ./client-js && npm install && cd ..

script:
  - npm test
  - cd ./client-js && npm test && cd ..

deploy:
  provider: elasticbeanstalk
  region: us-east-1
  app: url-shortener
  env: UrlShortener-env
  bucket_name: elasticbeanstalk-us-east-1-250241665995
  bucket_path: url-shortener
  on:
    branch: master
  access_key_id:
    secure: $AWS_ACCESS_KEY
  secret_access_key:
    secure: $AWS_SECRET_KEY
